# Lenovo Legion 5 15ARH05 - Custom TLP Configuration
# Managed by Legion Power Manager
# DO NOT EDIT MANUALLY - changes may be overwritten

# ========================================
# CPU Settings - AMD Ryzen 7 4800H
# ========================================
CPU_SCALING_GOVERNOR_ON_AC=performance
CPU_SCALING_GOVERNOR_ON_BAT=schedutil

CPU_ENERGY_PERF_POLICY_ON_AC=performance
CPU_ENERGY_PERF_POLICY_ON_BAT=balance_power

CPU_MIN_PERF_ON_AC=0
CPU_MAX_PERF_ON_AC=100
CPU_MIN_PERF_ON_BAT=0
CPU_MAX_PERF_ON_BAT=50

CPU_BOOST_ON_AC=1
CPU_BOOST_ON_BAT=0

# ========================================
# AMD Radeon Graphics
# ========================================
RADEON_DPM_PERF_LEVEL_ON_AC=auto
RADEON_DPM_PERF_LEVEL_ON_BAT=low

RADEON_DPM_STATE_ON_AC=performance
RADEON_DPM_STATE_ON_BAT=battery

RADEON_POWER_PROFILE_ON_AC=high
RADEON_POWER_PROFILE_ON_BAT=low

# ========================================
# Battery Management
# ========================================
# NOTE: Battery conservation and rapid charge are managed
# by Legion Power Manager via ACPI/sysfs.
# DO NOT set START/STOP_CHARGE_THRESH here!

# ========================================
# Disk & Runtime Power Management
# ========================================
SATA_LINKPWR_ON_AC=max_performance
SATA_LINKPWR_ON_BAT=med_power_with_dipm

AHCI_RUNTIME_PM_ON_AC=on
AHCI_RUNTIME_PM_ON_BAT=auto

# ========================================
# PCI Express
# ========================================
PCIE_ASPM_ON_AC=default
PCIE_ASPM_ON_BAT=powersupersave

# ========================================
# WiFi Power Saving
# ========================================
WIFI_PWR_ON_AC=off
WIFI_PWR_ON_BAT=on

# ========================================
# Audio Power Saving
# ========================================
SOUND_POWER_SAVE_ON_AC=0
SOUND_POWER_SAVE_ON_BAT=1

# ========================================
# USB Autosuspend
# ========================================
USB_AUTOSUSPEND=1
USB_EXCLUDE_AUDIO=1
USB_EXCLUDE_BTUSB=1
USB_EXCLUDE_PHONE=1
USB_EXCLUDE_PRINTER=1
USB_EXCLUDE_WWAN=1

# ========================================
# ThinkPad/IdeaPad Battery Features
# ========================================
NATACPI_ENABLE=1
TPACPI_ENABLE=1
TPSMAPI_ENABLE=0

# ========================================
# Runtime PM for PCI(e) bus devices
# ========================================
RUNTIME_PM_ON_AC=on
RUNTIME_PM_ON_BAT=auto

# Exclude discrete GPU from runtime PM if present
RUNTIME_PM_DRIVER_DENYLIST="nvidia nouveau"
